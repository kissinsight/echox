"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7608],{3905:(e,r,n)=>{n.d(r,{Zo:()=>c,kt:()=>g});var t=n(7294);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?a(Object(n),!0).forEach((function(r){o(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function l(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=t.createContext({}),d=function(e){var r=t.useContext(s),n=r;return e&&(n="function"==typeof e?e(r):i(i({},r),e)),n},c=function(e){var r=d(e.components);return t.createElement(s.Provider,{value:r},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},h=t.forwardRef((function(e,r){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=d(n),h=o,g=u["".concat(s,".").concat(h)]||u[h]||p[h]||a;return n?t.createElement(g,i(i({ref:r},c),{},{components:n})):t.createElement(g,i({ref:r},c))}));function g(e,r){var n=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var s in r)hasOwnProperty.call(r,s)&&(l[s]=r[s]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var d=2;d<a;d++)i[d]=n[d];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7931:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>d});var t=n(7462),o=(n(7294),n(3905));const a={description:"Error handling",slug:"/error-handling",sidebar_position:6},i="Error Handling",l={unversionedId:"guide/error-handling",id:"guide/error-handling",title:"Error Handling",description:"Error handling",source:"@site/docs/guide/error-handling.md",sourceDirName:"guide",slug:"/error-handling",permalink:"/docs/error-handling",draft:!1,editUrl:"https://github.com/labstack/echox/blob/master/website/docs/guide/error-handling.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{description:"Error handling",slug:"/error-handling",sidebar_position:6},sidebar:"docsSidebar",previous:{title:"Cookies",permalink:"/docs/cookies"},next:{title:"Start Server",permalink:"/docs/start-server"}},s={},d=[{value:"Default HTTP Error Handler",id:"default-http-error-handler",level:2},{value:"Custom HTTP Error Handler",id:"custom-http-error-handler",level:2},{value:"Error Pages",id:"error-pages",level:3}],c={toc:d},u="wrapper";function p(e){let{components:r,...n}=e;return(0,o.kt)(u,(0,t.Z)({},c,n,{components:r,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"error-handling"},"Error Handling"),(0,o.kt)("p",null,"Echo advocates for centralized HTTP error handling by returning error from middleware\nand handlers. Centralized error handler allows us to log errors to external services\nfrom a unified location and send a customized HTTP response to the client."),(0,o.kt)("p",null,"You can return a standard ",(0,o.kt)("inlineCode",{parentName:"p"},"error")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"echo.*HTTPError"),"."),(0,o.kt)("p",null,"For example, when basic auth middleware finds invalid credentials it returns\n401 - Unauthorized error, aborting the current HTTP request."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e.Use(func(next echo.HandlerFunc) echo.HandlerFunc {\n  return func(c echo.Context) error {\n    // Extract the credentials from HTTP request header and perform a security\n    // check\n\n    // For invalid credentials\n    return echo.NewHTTPError(http.StatusUnauthorized, "Please provide valid credentials")\n\n    // For valid credentials call next\n    // return next(c)\n  }\n})\n')),(0,o.kt)("p",null,"You can also use ",(0,o.kt)("inlineCode",{parentName:"p"},"echo.NewHTTPError()"),' without a message, in that case status text is used\nas an error message. For example, "Unauthorized".'),(0,o.kt)("h2",{id:"default-http-error-handler"},"Default HTTP Error Handler"),(0,o.kt)("p",null,"Echo provides a default HTTP error handler which sends error in a JSON format."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "message": "error connecting to redis"\n}\n')),(0,o.kt)("p",null,"For a standard ",(0,o.kt)("inlineCode",{parentName:"p"},"error"),", response is sent as ",(0,o.kt)("inlineCode",{parentName:"p"},"500 - Internal Server Error"),"; however,\nif you are running in a debug mode, the original error message is sent. If error\nis ",(0,o.kt)("inlineCode",{parentName:"p"},"*HTTPError"),", response is sent with the provided status code and message.\nIf logging is on, the error message is also logged."),(0,o.kt)("h2",{id:"custom-http-error-handler"},"Custom HTTP Error Handler"),(0,o.kt)("p",null,"Custom HTTP error handler can be set via ",(0,o.kt)("inlineCode",{parentName:"p"},"e.HTTPErrorHandler")),(0,o.kt)("p",null,"For most cases default error HTTP handler should be sufficient; however, a custom HTTP\nerror handler can come handy if you want to capture different type of errors and\ntake action accordingly e.g. send notification email or log error to a centralized\nsystem. You can also send customized response to the client e.g. error page or\njust a JSON response."),(0,o.kt)("h3",{id:"error-pages"},"Error Pages"),(0,o.kt)("p",null,"The following custom HTTP error handler shows how to display error pages for different\ntype of errors and logs the error. The name of the error page should be like ",(0,o.kt)("inlineCode",{parentName:"p"},"<CODE>.html")," e.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"500.html"),". You can look into this project\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/AndiDittrich/HttpErrorPages"},"https://github.com/AndiDittrich/HttpErrorPages")," for pre-built error pages."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'func customHTTPErrorHandler(err error, c echo.Context) {\n    code := http.StatusInternalServerError\n    if he, ok := err.(*echo.HTTPError); ok {\n        code = he.Code\n    }\n    c.Logger().Error(err)\n    errorPage := fmt.Sprintf("%d.html", code)\n    if err := c.File(errorPage); err != nil {\n        c.Logger().Error(err)\n    }\n}\n\ne.HTTPErrorHandler = customHTTPErrorHandler\n')),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Instead of writing logs to the logger, you can also write them to an external service like Elasticsearch or Splunk.")))}p.isMDXComponent=!0}}]);